<?xml version="1.0" encoding="utf-8" ?>
<Page
    x:Class="FluentFin.Plugins.Jellyseer.Views.JellyseerDashboardPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:ctk="using:CommunityToolkit.WinUI.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="using:FluentFin.Plugins.Jellyseer.Views"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:models="using:FluentFin.Plugins.Jellyseer.Models"
    x:Name="Page"
    mc:Ignorable="d">

    <ctk:SwitchPresenter TargetType="x:Boolean" Value="{x:Bind ViewModel.HasServer, Mode=OneWay}">
        <ctk:Case Value="True">
            <Grid Margin="36">
                <StackPanel Spacing="10">
                    <TextBlock Style="{ThemeResource SubtitleTextBlockStyle}" Text="Requests" />
                    <ScrollViewer
                        HorizontalScrollBarVisibility="Hidden"
                        HorizontalScrollMode="Enabled"
                        VerticalScrollBarVisibility="Hidden"
                        VerticalScrollMode="Disabled">
                        <ItemsRepeater Margin="0,0,15,0" ItemsSource="{x:Bind ViewModel.Requests, Mode=OneWay}">
                            <ItemsRepeater.ItemTemplate>
                                <DataTemplate x:DataType="models:MediaRequest">
                                    <local:JellyseerRequest
                                        Width="400"
                                        Height="210"
                                        Client="{Binding ElementName=Page, Path=ViewModel.Client}"
                                        CornerRadius="{StaticResource ControlCornerRadius}"
                                        Request="{x:Bind}" />
                                </DataTemplate>
                            </ItemsRepeater.ItemTemplate>
                            <ItemsRepeater.Layout>
                                <StackLayout Orientation="Horizontal" Spacing="10" />
                            </ItemsRepeater.Layout>
                        </ItemsRepeater>
                    </ScrollViewer>
                </StackPanel>
            </Grid>
        </ctk:Case>
        <ctk:Case Value="False">
            <Grid>
                <StackPanel
                    MinWidth="500"
                    Padding="50"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    CornerRadius="8"
                    Spacing="20">
                    <StackPanel.Background>
                        <SolidColorBrush Opacity="50" Color="#1e1e1e" />
                    </StackPanel.Background>
                    <StackPanel.Resources>
                        <Style TargetType="StackPanel">
                            <Setter Property="Spacing" Value="5" />
                        </Style>
                        <Style TargetType="TextBlock">
                            <Setter Property="FontWeight" Value="Bold" />
                        </Style>
                    </StackPanel.Resources>
                    <StackPanel>
                        <TextBlock Text="Jellyseer URL" />
                        <TextBox x:Name="UrlTextBox" />
                    </StackPanel>
                    <StackPanel
                        HorizontalAlignment="Center"
                        Orientation="Horizontal"
                        Spacing="10">
                        <Button
                            Command="{x:Bind ViewModel.SetServerUrlCommand}"
                            CommandParameter="{x:Bind UrlTextBox.Text, Mode=OneWay}"
                            Style="{ThemeResource AccentButtonStyle}">
                            <StackPanel Orientation="Horizontal" Spacing="10">
                                <FontIcon Glyph="&#xE8AB;" />
                                <TextBlock Text="Connect" />
                            </StackPanel>
                        </Button>
                    </StackPanel>
                </StackPanel>
            </Grid>
        </ctk:Case>
    </ctk:SwitchPresenter>
</Page>
